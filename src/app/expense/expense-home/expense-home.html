<mat-card>
  @if (hasSelectedExpense()) {
  <mat-card-title align="center" style="margin: 1rem">
    {{ this.newExpense() ? 'New Expense' : 'Expense Details' }}
  </mat-card-title>
  <mat-card-content>
    <app-expense-details
      [employees]="employees()"
      [expense]="expenseInDetail()"
      (saved)="saveExpense($event)"
      (deleted)="deleteExpense($event)"
      (closed)="refresh()"
    />
  </mat-card-content>
  } @else {
  <mat-card-title align="center" style="margin: 1rem">Expenses</mat-card-title>
  <mat-card-content>
    <table mat-table [dataSource]="expensesTable">
      <tr mat-header-row *matHeaderRowDef="tableColumns; sticky: true"></tr>
      <tr
        mat-row
        *matRowDef="let expense; columns: tableColumns"
        (click)="selectExpense(expense)"
      ></tr>
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>
          <div align="center"></div>
          ID
        </th>
        <td mat-cell *matCellDef="let expense">
          <div align="center"></div>
          {{ expense.id }}
        </td>
      </ng-container>
      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef>
          <div align="center">Date</div>
        </th>
        <td mat-cell *matCellDef="let expense">
          <div align="center">{{ expense.date | date : 'MM/dd/yyyy' }}</div>
        </td>
      </ng-container>
      <ng-container matColumnDef="employeeId">
        <th mat-header-cell *matHeaderCellDef>
          <div align="center">Employee</div>
        </th>
        <td mat-cell *matCellDef="let expense">
          <div align="center">{{ employeeOfId(expense.employeeId)?.lastName ?? 'N/A' }}</div>
        </td>
      </ng-container>
    </table>
  </mat-card-content>
  }
</mat-card>

@if (!hasSelectedExpense()) {
<mat-icon (click)="addNewExpense()" matTooltip="Add New Expense" class="addicon" color="primary">
  control_point</mat-icon
>
}
